"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;
var _express = _interopRequireDefault(require("express"));
var _passport = _interopRequireDefault(require("passport"));
var _dotenv = _interopRequireDefault(require("dotenv"));
var _googleAuthController = _interopRequireDefault(require("../controllers/googleAuthController.js"));
require("../config/authPassport.js");
var _protectRoute = _interopRequireDefault(require("../middleware/protectRoute.js"));
var googleRoute = _express["default"].Router();
_dotenv["default"].config();
googleRoute.get("/api/auth/google", _passport["default"].authenticate("google", {
  scope: ["email", "profile"]
}));
googleRoute.get("/api/auth/google/callback", _passport["default"].authenticate("google", {
  successRedirect: "/auth/google/protected",
  failureRedirect: "/auth/google/failure"
}));
googleRoute.get("/auth/google/protected", isLoged, _googleAuthController["default"]);
googleRoute.get("/auth/google/failure", function (req, res) {
  res.redirect("".concat(process.env.FRONTEND_URL, "/login"));
});
function isLoged(req, res, next) {
  req.user ? next() : res.sendStatus(401);
}
var _default = googleRoute;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZXhwcmVzcyIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX3Bhc3Nwb3J0IiwiX2RvdGVudiIsIl9nb29nbGVBdXRoQ29udHJvbGxlciIsIl9wcm90ZWN0Um91dGUiLCJnb29nbGVSb3V0ZSIsImV4cHJlc3MiLCJSb3V0ZXIiLCJkb3RlbnYiLCJjb25maWciLCJnZXQiLCJwYXNzcG9ydCIsImF1dGhlbnRpY2F0ZSIsInNjb3BlIiwic3VjY2Vzc1JlZGlyZWN0IiwiZmFpbHVyZVJlZGlyZWN0IiwiaXNMb2dlZCIsImdvb2dsZUF1dGgiLCJyZXEiLCJyZXMiLCJyZWRpcmVjdCIsImNvbmNhdCIsInByb2Nlc3MiLCJlbnYiLCJGUk9OVEVORF9VUkwiLCJuZXh0IiwidXNlciIsInNlbmRTdGF0dXMiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlcyI6WyIuLi8uLi9zcmMvcm91dGVycy9nb29nbGVBdXRoLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBleHByZXNzIGZyb20gXCJleHByZXNzXCI7XG5pbXBvcnQgcGFzc3BvcnQgZnJvbSBcInBhc3Nwb3J0XCI7XG5pbXBvcnQgZG90ZW52IGZyb20gXCJkb3RlbnZcIjtcbmltcG9ydCBnb29nbGVBdXRoIGZyb20gXCIuLi9jb250cm9sbGVycy9nb29nbGVBdXRoQ29udHJvbGxlci5qc1wiO1xuaW1wb3J0IFwiLi4vY29uZmlnL2F1dGhQYXNzcG9ydC5qc1wiO1xuaW1wb3J0IHByb3RlY3QgZnJvbSBcIi4uL21pZGRsZXdhcmUvcHJvdGVjdFJvdXRlLmpzXCI7XG5jb25zdCBnb29nbGVSb3V0ZSA9IGV4cHJlc3MuUm91dGVyKCk7XG5kb3RlbnYuY29uZmlnKCk7XG5nb29nbGVSb3V0ZS5nZXQoXG4gIFwiL2FwaS9hdXRoL2dvb2dsZVwiLFxuICBwYXNzcG9ydC5hdXRoZW50aWNhdGUoXCJnb29nbGVcIiwgeyBzY29wZTogW1wiZW1haWxcIiwgXCJwcm9maWxlXCJdIH0pXG4pO1xuZ29vZ2xlUm91dGUuZ2V0KFxuICBcIi9hcGkvYXV0aC9nb29nbGUvY2FsbGJhY2tcIixcbiAgcGFzc3BvcnQuYXV0aGVudGljYXRlKFwiZ29vZ2xlXCIsIHtcbiAgICBzdWNjZXNzUmVkaXJlY3Q6IFwiL2F1dGgvZ29vZ2xlL3Byb3RlY3RlZFwiLFxuICAgIGZhaWx1cmVSZWRpcmVjdDogXCIvYXV0aC9nb29nbGUvZmFpbHVyZVwiLFxuICB9KVxuKTtcbmdvb2dsZVJvdXRlLmdldChcIi9hdXRoL2dvb2dsZS9wcm90ZWN0ZWRcIiwgaXNMb2dlZCwgZ29vZ2xlQXV0aCk7XG5nb29nbGVSb3V0ZS5nZXQoXCIvYXV0aC9nb29nbGUvZmFpbHVyZVwiLCAocmVxLCByZXMpID0+IHtcbiAgcmVzLnJlZGlyZWN0KGAke3Byb2Nlc3MuZW52LkZST05URU5EX1VSTH0vbG9naW5gKTtcbn0pO1xuXG5mdW5jdGlvbiBpc0xvZ2VkKHJlcSwgcmVzLCBuZXh0KSB7XG4gIHJlcS51c2VyID8gbmV4dCgpIDogcmVzLnNlbmRTdGF0dXMoNDAxKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZ29vZ2xlUm91dGU7XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQSxJQUFBQSxRQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxTQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxPQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRyxxQkFBQSxHQUFBSixzQkFBQSxDQUFBQyxPQUFBO0FBQ0FBLE9BQUE7QUFDQSxJQUFBSSxhQUFBLEdBQUFMLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFNSyxXQUFXLEdBQUdDLG1CQUFPLENBQUNDLE1BQU0sQ0FBQyxDQUFDO0FBQ3BDQyxrQkFBTSxDQUFDQyxNQUFNLENBQUMsQ0FBQztBQUNmSixXQUFXLENBQUNLLEdBQUcsQ0FDYixrQkFBa0IsRUFDbEJDLG9CQUFRLENBQUNDLFlBQVksQ0FBQyxRQUFRLEVBQUU7RUFBRUMsS0FBSyxFQUFFLENBQUMsT0FBTyxFQUFFLFNBQVM7QUFBRSxDQUFDLENBQ2pFLENBQUM7QUFDRFIsV0FBVyxDQUFDSyxHQUFHLENBQ2IsMkJBQTJCLEVBQzNCQyxvQkFBUSxDQUFDQyxZQUFZLENBQUMsUUFBUSxFQUFFO0VBQzlCRSxlQUFlLEVBQUUsd0JBQXdCO0VBQ3pDQyxlQUFlLEVBQUU7QUFDbkIsQ0FBQyxDQUNILENBQUM7QUFDRFYsV0FBVyxDQUFDSyxHQUFHLENBQUMsd0JBQXdCLEVBQUVNLE9BQU8sRUFBRUMsZ0NBQVUsQ0FBQztBQUM5RFosV0FBVyxDQUFDSyxHQUFHLENBQUMsc0JBQXNCLEVBQUUsVUFBQ1EsR0FBRyxFQUFFQyxHQUFHLEVBQUs7RUFDcERBLEdBQUcsQ0FBQ0MsUUFBUSxJQUFBQyxNQUFBLENBQUlDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxZQUFZLFdBQVEsQ0FBQztBQUNuRCxDQUFDLENBQUM7QUFFRixTQUFTUixPQUFPQSxDQUFDRSxHQUFHLEVBQUVDLEdBQUcsRUFBRU0sSUFBSSxFQUFFO0VBQy9CUCxHQUFHLENBQUNRLElBQUksR0FBR0QsSUFBSSxDQUFDLENBQUMsR0FBR04sR0FBRyxDQUFDUSxVQUFVLENBQUMsR0FBRyxDQUFDO0FBQ3pDO0FBQUMsSUFBQUMsUUFBQSxHQUVjdkIsV0FBVztBQUFBd0IsT0FBQSxjQUFBRCxRQUFBIn0=